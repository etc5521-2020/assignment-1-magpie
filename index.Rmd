---
title: "ETC5521 Assignment 1"
subtitle: "Education System in the US"
team: Magpie
author:
  - Junhao Wang 
  - Priya Ravindra Dingorkar
  - Aarathy Babu
  - Siddhant Tirodkar
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    toc: true
    toc_float: true
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = F)

# devtools::install_github("hrbrmstr/ggalt")
#install.packages("lvplot")
#devtools::install_github("josiahpjking/jkr")
library(tidyverse)
library(dplyr)
library(kableExtra)
library(ggridges)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(gridExtra)
library(scales)
library(DT)
library(plotly)
library(grid)
library(lemon)
library(lvplot)
library(visdat)
library(GGally)
library(jkr)
library(ggalt)
library(gganimate)
library(png)
library(gifski)

```

# Acknowledgements

Our sincere gratitude goes out to Professor Dianne Cook, Dr Emi Tanka, and the tutors Sayani Gupta and Sherry Zhang for their guidance and encouragement. Their cumulative efforts have placed us in a position where we can generate this report collaboratively.

# Introduction and Motivation

Attending a university course is a big decision for students because it will have a large effect on the advancement of a person’s future with a huge cost of both, money and time. It is safe to say that attending university is indeed an investment and the return on investment is very worrying.

Everyone knows that the US is one of the most popular yet costly higher education destinations in the world, and the cost range is wide (for example: tuition fees range from $5,000 to $50,000 (£4,074-£ 40,746) per annum). Most undergraduate degrees last four years, so on an average students graduate with a debt of $132,860 (£101,505). Also, the tuition cost in US universities have been on the rise since the very beginning as can be seen in figure \@ref(fig:animate). Given this, we are interested in evaluating the quality of investment in American education.

In this report , we will look at the various factors that influence the US education and whether studying at the renowned US universities is really worth the investment. On thorough analysis of this we have realized that there are several variables in the dataset that enabled us to assess the cost and expenditure of studying in the US. We have tried our best to cover most of the important variables which allow us to evaluate and analyse efficiently. Since most variables have character datatypes, and a few in numeric, the visualisation scope is very limited.


```{r dat-load, message = FALSE, echo=FALSE}
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')

tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 

salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')

historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')

diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv')
```

```{r animate, fig.cap="*The animation tracks the change in tuition fees in institutions in the US. An increasing trend is seen in both public and private universities and among the two, private institutions are more expensive.*"}
# using the gsub function to match the pattern and mutating year using the lubridate package
library(gganimate)
  historical_tuition$year<- gsub("-.*","",historical_tuition$year)
   historical_tuition1<-  historical_tuition %>%
    mutate(year=as.Date(year,format='%Y'),
           year=lubridate::year(year))
# using filter to choose appropriate years and using gganimate library to show a animation
  historical_tuition1 %>%
     filter(tuition_type=="All Constant")%>%
     filter(type!="All Institutions") %>%
     ggplot(aes(x=year,y=tuition_cost,color=type))+
     geom_line()+
    labs(color = "Type")+
    xlab("Tuition")+
    ylab("Year")+ggtitle("Tuition Cost across the years")+
  transition_reveal(year)
   
   
```

# Research Question

## Primary Question

How valuable is the investment in education among American universities? 

Since tuition fee is relatively high for most students or their families, value for money is of great concern. This question is to discover how highly the tuition fees are valued among universities in America by analysing the various aspects of the education system in US.

## Secondary Questions

* How does the tuition fee vary across the different types of institutions? 
This information can be drawn from tuition cost, and can give a point of view of the American education system.

* What is the ratio of net-cost to total cost among America universities?
This can show how much burden a student has taken.

* How is student's career development among America universities? 
This information can be drawn from *salary_potential*, if middle-career pay differ a lot from early-career pay, then we believe there is a well career development in that university.

* How does the tuition rate vary over the various years for the various types of courses?

* What is percentage of enrolment of the diverse population studying, across the US ?

* Are all States and universities accommodative of students of different ethnic and economic backgrounds?

* Does paying high tuition guarantee a higher salary? Which college has more potential in career growth on the basis of initial salary offered?

# Data description 

It is through data collection that a business or management has quality information that they need for further analysis, studies and research to make informed decisions.

We will perform exploratory data analysis in this study on the subject of [**College Tuition, Diversity and Pay Dataset**](https:/github.com / rfordatascience / tidytuesday / blob / master / data/2020/2020-03-10 / readme.md). 

This collection of data primarily receives all the information from various sources but originally from the US Department of Education.

The data taken from the original pages turned out to be very large in size which is why the author has, for the convenience of the audience and to produce informative results, filtered the data into five comma-separated documents using web scraping in R with the support of the *rvest package 2020*.

Upon further inspection, we also found out that some of the datasets have a few *missing values* using the *visdat package 2020*. We have dealt with all of them and removed all the missing values.

Let’s look at the small snippets of the various data sets and the percentage of missing values in the variables to get a better understanding of the variables.

## Data on Diversity

The *diversity_school* data set comes [The Chronicle of Higher Education](https://www.chronicle.com/article/student-diversity-at-4-725-institutions).

```{r}
# using vis_miss to show missing values in the diversity dataset
vis_miss(diversity_school)
```

```{r}
diversity_school <- diversity_school %>%
  filter(!is.na(name)) %>%
  filter(!is.na(state))
```

- Name has data type character properties that describe the school name.
- Total Enrolment has double datatype properties representing the total number of students enrolled.
- State has character datatype representing the various states.
- Category has character properties defining the group Group / Race / Gender.
- Enrolment has double datatype properties specifying the specific enrolment.

## Data on History 

The *historical_tuition* dataset been obtained from [U.S. Department of Education, National Center for Education Statistics.](https://nces.ed.gov/fastfacts/display.asp?id=76)

```{r}
# using vis_miss to show missing values in the history dataset
vis_miss(historical_tuition)
```

```{r ht, echo=FALSE}
head(historical_tuition,3) %>% kableExtra::kable() %>% kableExtra::kable_styling(c("hover" , "striped"))
```

- type variable having character datatype describes the Type of school (All, Public, Private).
- year having character format describes the corresponding Academic year.
- tuition_type having	character datatype refers to duration of the degree, Tuition Type All Constant (dollar inflation adjusted), 4 year degree constant, 2 year constant, Current to year, 4 year current, 2 year current.
- tuition_cost having	double datatype represents the education fees/Tuition cost in USD.

## Data on Salary Potential

*Salary_potential* data set origins from [Payscales](https://www.payscale.com/college-salary-report/best-schools-by-state/bachelors/new-hampshire).

```{r,message=FALSE, warning=FALSE}
# using vis_miss to show missing values in the salary potential dataset
vis_miss(salary_potential) 
```

```{r}
salary_potential <- salary_potential %>%
  filter(!is.na(make_world_better_percent))
```

```{r sp, echo=FALSE}
head(salary_potential,3) %>% kableExtra::kable() %>% kableExtra::kable_styling(c("hover" , "striped"))
```

- rank having	double datatype properties defines the potential salary rank within state.
- early_career_pay having double datatype defines the	estimated early career pay in USD.
- mid_career_pay having double datatype defines the	estimated mid career pay in USD.
- make_world_better_percent having double datatype represents the	percent of alumni who think they are making the world a better place.
-stem_percent having double datatype defines the percent of student body in science, technology, engineering and mathematics (STEM).

## Data on the Tuition Cost

The Tuition cost data set is obtained from [the Chronicle of Higher Education.](https://www.chronicle.com/article/tuition-and-fees-1998-99-through-2018-19)

```{r}
# using vis_miss to show missing values in the tuition cost dataset
vis_miss(tuition_cost)
```

```{r}
# not removing room and board na values as we are not considering it in analysis 
tuition_cost <- tuition_cost %>% filter(!is.na(state))
```


```{r tc, echo=FALSE}
head(tuition_cost,3) %>% kableExtra::kable() %>% kableExtra::kable_styling(c("hover" , "striped"))
```

- in_state_tuition having double datatype depicts the Tuition fee for in-state residents in USD.
- out_of_state_tuition having double datatype	Tuition for out-of-state residents in USD.

## Data on Tuition Income

The tuition income has been obtained from the dataset [Tuition Tracker](https://www.tuitiontracker.org/) and [Priceconomics.](https://priceonomics.com/ranking-the-most-and-least-diverse-colleges-in/).

```{r}
# using vis_miss to show missing values in the tuition income dataset
vis_miss(tuition_income,warn_large_data = F)
```

```{r ti, echo=FALSE}
head(tuition_income,3) %>% kableExtra::kable() %>% kableExtra::kable_styling(c("hover" , "striped"))
```
 
- campus having	character datatype depicts whether the school is	On or off-campus.
- net_cost having double datatype denotes Net-cost - average actually paid after scholarship/award.
- income_lvl having	character datatype provides information about the	Income bracket.

## Data Structure and Cleaning Process

All the information gathered in these different data files was achieved by web scraping using the rvest library, html nodes, html url, and generating data set in tibble, mutating new columns and linking rows together later on. All the data was scraped and written in csv and later, the csv was read in to R environment using the readr function.

# Analysis and Findings

One of the key reasons students chose to study in the US is the prestige of the country for renowned higher education programs. Completing a degree from one of the best higher education programs in the world would make you stand out from peers of similar backgrounds and job experiences. 

Let us examine and know the important facts about the US education system. We look at the various aspects when studying, the diversity of education, the history of education, the cost of tuition, income among people in the US, the different wages currently on the market, and similar exciting analyses.

## The Distribution of Tuition Fees in US.

Let us look at the distribution of the spectrum of tuition fees in the US for residents and non-residents of the US across the various types of institutions in the US.

```{r dist-tut, fig.cap="Distribution of Tuition Fees in US", fig.align='center', message=FALSE, warning=FALSE}

library(gridExtra)
ridges_dat <- tuition_cost %>% dplyr::filter(tuition_cost$type != "Other") 


```


```{r}

# a histogram (probability densities instead of frequencies) + density is plotted to distinguish between non residents and residents. campus & degree length is also taken into consideration 

cols <- c("Residents"="#457b9d","Non Residents"="red")
two <- ridges_dat %>%
  filter(degree_length=="2 Year")%>%
  ggplot()+
  geom_histogram(aes(x = in_state_tuition,y=..density..,fill="Residents"))+
  geom_density(aes(x=out_of_state_tuition,color="Non Residents"))+
  facet_wrap(~type)+
  xlab("Tuition")+ylab("Density")+
  ggtitle("2 Year Degree")+
  scale_colour_manual(name="",values=cols) + scale_fill_manual(name="",values=cols) 




## Data on the Tuition Cost

four <- ridges_dat %>%
  filter(degree_length=="4 Year")%>%
  ggplot()+
  geom_histogram(aes(x = in_state_tuition,y=..density..,fill="Residents"))+
  geom_density(aes(x=out_of_state_tuition,color="Non Residents"))+
  facet_wrap(~type)+
  xlab("Tuition")+
  ylab("Density")+
  ggtitle("4 Year Degree")+
  scale_colour_manual(name="",values=cols) + 
  scale_fill_manual(name="",values=cols)


```


```{r tuitiondist, fig.cap="*The histogram and density distribution show the distribution of tuition feesof residents and non-residents of US across 2-Year and 4-Year degree courses. Though both residents and non-residents enrol more in public universities, non-residents end up paying more.*", fig.align='center', fig.height=6.5, message=FALSE, warning=FALSE}
# using grid arrange to show the two plots together
grid_arrange_shared_legend(two,four,ncol=1, nrow=2)
```

Figure \@ref(fig:tuitiondist) displays the distribution of tuition fees for the residents and non-residents of US. Majorly the universities in the US offer two types of degree courses, 2-Year degree courses and 4-Year degree courses. 2-Year degree courses are predominantly for students enrolled in a master's degree and 4-Year degree courses are generally offered to students pursuing a bachelor's degree. We have separated the two and plotted two different graphs as tuition fee varies majorly for the two different types of courses offered. As seen in \@ref(fig:tuitiondist), the red density plot depicts the tuition fee for non-residents and the histogram depicts the tuition fee for residents. We observe that the density in private universities is low as compared to the other two as this may be due to the higher expense of fees in private universities. It is clear from the above figure that both citizens and non-residents of the US enrol in for profit or public universities to pursue higher education. Another noticeable fact is that, in public universities, non-residents end up paying more than citizens of the US.

## Difference in fees after any Scholarship / Awards Earned

A lot of students receive grants and scholarships of various kinds. Through this section, we will understand how the grants/scholarships are awarded to students of various income groups how much cost students end up bearing across various income groups.

```{r stunetfee, fig.cap="*The stacked barplot shows the average net cost students pay across various income groups over the years for off campus and on campus education in US universities.*", fig.align='center', fig.height=9, fig.width=9, message=FALSE, warning=FALSE}
# first recoded the inappropriate value, then mutated netcost variable to round it off to 2 decimal points 
tuition_income$income_lvl <- recode(tuition_income$income_lvl,
                                  "48_001 to 75,000"="48,001 to 75,000") 
tuition_incometest <- tuition_income %>%
  mutate(net_cost=round(net_cost,2)) %>%

# grouped by year campus and income_lvl and summarised using mean of net_cost
  group_by(year,campus,income_lvl)%>%
  summarise(each=mean(net_cost))
# plotted a stacked histogram using ggplot
plo <- ggplot(tuition_incometest, aes(income_lvl,each, fill=campus)) +
  geom_col(position = 'dodge') +
  facet_wrap(~year) + 
  theme(axis.text.x = element_text(angle=90)) +
  ggtitle("Average Cost incurred after Scholarship for each Income group") +  
  xlab("Income Level of the University Applicants")+
  ylab("Difference in the Fees after Scholarship")
plo



```

```{r stuscholar, fig.cap="*The stacked barplot show the amount of scholarships students earn across various income groups in US universities over the yearsfor on campus and off campus education.*", fig.align='center', fig.height=9, fig.width=9, message=FALSE, warning=FALSE}
# followed similar steps and calculated the scholarship as the difference between total cost and net cost 
 tuition_income %>% 
  mutate(diff = total_price - net_cost) %>%
  group_by(year,campus,income_lvl)%>%
  summarise(eachscho=mean(diff))  %>%

ggplot( aes(x=income_lvl, y=eachscho, fill= campus)) +
  geom_col(position ='dodge') +
  facet_wrap(~year) + 
  theme(axis.text.x = element_text(angle=90)) + 
  labs(y="Scholarship", 
       x="Income Level of the University Applicants"
      ) +
  ggtitle("Average Scholarship Received by each Income Group")

```

In the US, university courses are broadly offered on campus and off campus. Though there is only a little difference between the net_cost of both on campus and off campus courses, the total_cost varies significantly and hence we have displayed them independent of each other. In figure \@ref(fig:stunetfee) we have the average cost that a student incurs across various income groups and in figure \@ref(fig:stuscholar) we have the scholarships earned by students across various income groups. A point to note is that the variable net_cost has a lot of *negative values*. One may wonder how can the tuition paid be negative. Upon further probing we found out that a lot of universities provide financial assistance to students and extend it to their families as well. This is the reason the variable net_cost shows negative values. Also, the data for on campus courses for the year 2010 is missing. Besides we have also recoded the category of income level of *48,001 to 75,000* which earlier was *48_000 to 75,000*.

In Figure \@ref(fig:stunetfee) we group by the year, net cost and the income levels and summarise using the mean to arrive at the average tuition cost students pay across various income groups. It is clear from the figure that students in lower income groups tend to take less burden of tuition fee as compared to students with higher income groups over the years.

In figure \@ref(fig:stuscholar) we obtain the amount of scholarship earned by the students by finding out the difference between the total_cost and net_cost. Then we summarise using the mean to arrive at the average scholarship earned by each income group. Clearly, students in lower income groups earn more scholarships as compared to those in higher income groups over the years. An interesting point to note is that in 2017 and 2018 the income group of over USD 110,000 the off campus students have received more scholarships than on campus students.

## Student's Career Development among American States

After graduating, a student's improvement can be calculated in terms of his salary growth. Let's look at the various states, where we see the greatest change in the salary growth.

```{r studdevelop, fig.cap="*The bar chart depicts the average salary growth of students in the states of US with states ordered according to the improvement rates. Students from Wyoming, New Mexico,California showcase high career growth whereas Delaware, Alaska show relatively less growth.*", fig.align='center',fig.height=6.5, message=FALSE, warning=FALSE}
# calculated the improvement percentage using mutate then grouped by state and summarised using mean for the improvement %
salary_potential <-salary_potential %>% 
  mutate(improvement= (mid_career_pay-early_career_pay)*100/early_career_pay)

 salary_potential %>% 
     group_by(state_name) %>%
   summarise(mean=mean(improvement)) %>%
  ggplot(aes(y = reorder(state_name, mean), x = mean)) +
 geom_bar(stat='identity', fill = "blue",alpha=0.5, width = 0.75) + 

  labs(x="Improvement of Salaries (%) ", 
       y="States of the US"
      ) + ggtitle("Salary Improvement")

```

To compute the improvement in a student's career, we calculated the percentage of increase in an individual's salary through his career and grouped by the states and summarized using the mean to arrive at the average increase in salaries across various states and reordered them.

In figure \@ref(fig:studdevelop) we can clearly see that individuals graduating from universities in the states of Wyoming, New-Mexico, California, New-York and Ohio show the highest growth in mid-career salaries and the states of Delaware, North-Dakota, Alaska, Idaho and New-Hampshire show the least growth in mid-career salaries. Though there is not a huge difference between the state offering the highest growth and the state offering the least growth, figure \@ref(fig:studdevelop) is a great tool to understand a student's career growth in different states.

Furthermore, we have created a table,table \@ref(fig:imp), to depict all the universities whose alumni experienced a career growth of more than 75%. We have also ranked the universities state-wise in terms of the improvement. The table enables the user to find the top universities in any state and the improvement percentage as well. 

```{r improvementrate}
# filtering the colleges with more than 75% improvement and arranging in a descending order using arrange()
top_colleges <- salary_potential %>% 
dplyr::filter(improvement >75) %>%  
  dplyr::select(name, state_name, rank,improvement) %>%
  arrange(desc(improvement))
```

```{r imp, fig.cap="*The interactive table shows the list of Institutions whose alumni experienced a career growth of more than 75 % along with the rank of the university in each state.*", fig.align='center'}
# using the DT package to display an interactive table
DT::datatable(top_colleges, 
              rownames = FALSE,
              filter="top", 
              options = list(pageLength = 5, scrollX=T))
```


## Alumni of US that Make World a Better Place to Live

Alumni serve many important positions, such as helping create and develop the brand of an organization through word-of-mouth marketing. Alumni play a significant role in promoting organizations that benefit students and their activities. Let us look at alumni from different US states who make an impact in the world.

```{r bcc, fig.cap="*The circular bar plot depicts the average percentage of Alumni of institutions in each state of the US, who believe they are making the world a better place. Ordered according to the proportion, the plot shows that alumni from New Mexico believe they make a positive impact on the world*", fig.align='center', fig.height=9, fig.width=9, message=FALSE, warning=FALSE}
# first removed all the missing values from the variable make_world_a_better_place
na <- salary_potential %>%
  filter(is.na(make_world_better_percent)) # 33 na values 

# grouped by using the state name and summarised using mean of make_world_a_better_place
alumni <- salary_potential %>%
  filter(!is.na(make_world_better_percent)) %>%
  group_by(state_name) %>%
  summarise(mean=mean(make_world_better_percent))
empty_bar <- 40
 

to_add <- matrix("", empty_bar, ncol(alumni))
colnames(to_add) <- colnames(alumni)
data <- rbind(alumni, to_add)
data <- data %>%
  mutate(mean=as.numeric(mean))

# reordered using state name and plotedd a histogram
data %>%
ggplot(aes(x=reorder(state_name,mean), y= mean,fill=mean)) +
  geom_bar(stat="identity") +
   theme_minimal() + 
 scale_fill_viridis_c()+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y = element_blank()) + 
  ggtitle("Alumni who believe they make the world a better place to Live")   +
  theme(axis.text.x = element_text(hjust = 5))+
  theme(plot.title = element_text(hjust = 0.5)) +
    labs(fill = "Percentage of Alumni")+
   theme(legend.position ="bottom",
          legend.direction = "horizontal")+
 # scale_x_discrete(guide = guide_axis(n.dodge = 2))+
  coord_polar(start = 0)
  
```

To arrive at figure  \@ref(fig:bcc) we grouped by the state and summarized using the mean to calculate at the average percentage of alumni who think they make the world a better place. Later, we plotted the circular bar chart using the mean value to colour the bars to distinguish the states appropriately. We also reordered it to clearly display the state in which students think they make the most impact and the least impact.

It is clear from figure \@ref(fig:bcc) that more alumni from states, New-Mexico, Mississippi and Louisiana think they contribute towards making greater impact in the world where as the alumni from states of Nevada, Rhode-Island and New-Jersey believe they do not contribute enough. 

## Diversity in Education in US

US is ranked amongst the top countries, showing cultural diversity owing to students coming from around the world. Let's evaluate the various groups and their percentage of US university enrolment.

```{r lvplot, fig.cap="*The Percentage of Enrolment across different universities in the US is depicted in the Letter Value plot. Half of the enrolments across US see 60 % of the total enrolment of an institution as White where as overwhelmingly low percentage of American Indian and Native Hawaiian enrolment is seen.*", fig.align='center', message=FALSE, warning=FALSE,fig.height=6}

# first removed total minority, then added few categories to other then used  an LV plot from LVplot to render a LVplot

diversity_school_excludedtm <- diversity_school %>% mutate(Per = enrollment/total_enrollment*100) %>%
  filter(category!="Total Minority")
diversity_school_excludedtm$category <- recode(diversity_school_excludedtm$category,
                                  "Two Or More Races"="Other",
                                  "Unknown"="Other",
                                  "Non-Resident Foreign"="Other") 

ggplot(data=diversity_school_excludedtm) + 
 geom_lv(aes(x=category,y=Per,fill=..LV..)) +
scale_fill_viridis_d() + 
  ggtitle("Diversity in Education")+
  xlab("Category")+
  ylab("Percentage of Enrollment")+
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10))+
  
  theme(axis.text.x = element_text(angle=90))

```

To calculate the percentage of US university enrolment amongst various ethnic groups, first we removed the Total Minority as it was a summation of all minority ethnic categories like 'Asian', 'Black' etc. Besides we added *Two Or More Races*, *Unknown* and *Non-Resident Foreign* to the other category as they individually contribute very little to the enrolment data. To plot the values, we utilized a *Letter Value Boxplot* using the *lvplot R package 2020* instead of a traditional boxplot as can be seen in figure \@ref(fig:lvplot)

A letter value boxplot overcomes the shortcomings of a conventional boxplot and conveys more information in the tails or the outliers using letter values. The legend besides the letter value plot mentions certain alphabets and the colour they represent on the letter value plot.

- M represents the median and roughly 50% of the observations.
- F represents the quartiles and roughly 25% of the observations.
- E denotes roughly 12.5% of the observations.
- D denotes roughly 6.25% of the observations.
- C denotes roughly 3.13% of the observations.
- B denotes roughly 1.56% of the observations.
- A denotes roughly 0.8% of the observations.
- Z denotes roughly 0.4% of the observations.
- Y denotes roughly 0.2% of the observations.
- X denotes roughly 0.1% of the observations.
- W denotes roughly 0.05% of the observations.

It is clear from figure \@ref(fig:lvplot) that people of White race form the majority of students enrolled in American universities followed by Black race  and other minorities. Native Hawaiian/Pacific Islander and American Indian/Alaska Native category of ethnic groups observe least enrolment in American universities.


## Is diversity amongst students in the United States the same across all states and universities?

In this section, we will investigate how accommodative different states are of various minorities in their universities and to do so, we have explored the percentage of different minorities enrolled in universities across the US.

```{r mincal}
library(leaflet)
#filtered for total minority and calculated minority % using mutate and summarised using the mean
min <- diversity_school %>% 
  filter(category=="Total Minority") %>% 
  mutate(minoritypercent = (enrollment/total_enrollment)*100) %>%
  group_by(state) %>% 
  summarise(meanminority=mean(minoritypercent,na.rm = T)) 

min$meanminority <- round(min$meanminority,2)

```

```{r leaflet, fig.cap="*The figure is an interactive map by leaflet which shows the average percentage of minority in schools of each state. Hawaii has the most accommodative institutions in the US with an average 71.67% minority whereas the least accommodative is Maine with 9.92%.*"}
# used a US state map using the leaflet package to plot the minority % over all the US states
# also used a geojson file which contained all the geographical info
states <- geojsonio::geojson_read("json/us-states.geojson", what = "sp")


pal <- colorNumeric("viridis", domain = states$density)

hawaii <- min %>%
  filter(state=="Hawaii")
labels <- sprintf(
  "<strong>%s</strong><br/>%g Percent",

  min$state, min$meanminority
) %>% lapply(htmltools::HTML)

content <- sprintf(
  "<strong>%s</strong><br/>%g Percent",

  hawaii$state,hawaii$meanminority
) %>% lapply(htmltools::HTML)


leaflet(states,options = leafletOptions(minZoom = 3)) %>%
  setView(-120.233256, 41, 3) %>%
  addProviderTiles("MapBox", options = providerTileOptions(
    id = "mapbox.light",
    accessToken = Sys.getenv('MAPBOX_ACCESS_TOKEN'))) %>%
  addPolygons(
    fillColor = ~pal(density),
    weight = 2,
    opacity = 1,
    color = "white",
    dashArray = "3",
    fillOpacity = 0.7,
    highlight = highlightOptions(
      weight = 5,
      color = "#666",
      dashArray = "",
      fillOpacity = 0.7,
      bringToFront = TRUE),
    label = labels,
    labelOptions = labelOptions(
      style = list("font-weight" = "normal", padding = "3px 8px"),
      textsize = "15px",
      direction = "auto")) %>%
  addPopups(-155.634835,21.948267, content,
    options = popupOptions(closeButton = FALSE)
  ) %>%
  addLegend(pal = pal, values = ~density, opacity = 0.9, title = "Percentage of Minority",
    position = "topright")

```

To plot the minorities across various US states, first we calculated the enrolment percentage for all minorities in US universities and then made use of a leaflet plot in the *R leaflet package 2020* to plot the minority percentages across different US states as seen in figure \@ref(fig:leaflet). This was done with the help of a geojson file which contains the geographical information. The figure or the choropleth map is interactive and hovering over individual states show the percentage of minorities enrolled in universities in those states.

From the figure, it is visible that the universities in the state of Hawaii harbours the most amount of minority groups and the state of Maine harbours the least.


After looking at the states and their accommodative nature of accepting different ethnic backgrounds, we now shift our focus to look at how expensive and inexpensive universities accommodate students of different ethnic backgrounds.

```{r averagecal}
# grouped by the name of universities then summarised using mean the in_state_total cost of tuition fee
# then arranged according to the top 50 expensive and top 50 inexpensive colleges
averagecal <- tuition_cost %>% 
  group_by(name) %>%
  summarise(avg_fee=mean(in_state_total))
ex <- averagecal %>%
  arrange(desc(avg_fee)) %>%
  head(50) 

inex <- averagecal%>% 
  arrange((avg_fee)) %>%
  head(50) 
```

To categorise universities into the economic groups, *Expensive* and *Inexpensive*, we first grouped all the universities by their name, summarized them to find the mean tuition cost and reordered them according to the top 50 colleges with the highest tuition fees and the bottom 50 colleges with the lowest tuition fees. Later, we joined the dataset showing tuition with the diversity dataset using the name of the universities and filtered out the total minorities, women and other categories to showcase the distribution better. We also calculated the enrolment percentages for the top 50 expensive and bottom 50 inexpensive colleges and rendered two separate plots as shown below to display the percentage of students of various ethnic groups enrolled in US universities.


```{r stack, fig.width=10,fig.height=8, fig.cap="*The horizontal stacked bar plot depicts the proportion of enrolments in the top 50 expensive educational institutions in the US, according to ethnicity. An overwhelmingly large population of people having White ethnicity is seen where Hispanic, Black ,Asian population form the minority.*"}
# joined the diversity and tuition cost dataset using an inner join and recoded some categories to other
# then calculated enrollment percentage for all the colleges using mutate
# then created a stacked barplot using ggplot and filled with different diversity groups for top 50 expensive colleges
econ <- diversity_school
econ$category <- recode(econ$category,
                                  "Two Or More Races"="Other",
                                  "Unknown"="Other",
                                  "Non-Resident Foreign"="Other") 

econ <- econ %>% 
  filter(category!="Total Minority") %>%
  filter(category!="Other") %>%
  filter(category!="Women")
 
 diversity_cost_ex <- econ  %>%
  
  inner_join(ex,by="name") 
 
 
diversity_cost_ex <-diversity_cost_ex %>% 
  mutate(proportion=(enrollment/total_enrollment)*100)

  propor_cat_ex <- diversity_cost_ex %>%
   filter(category=="White") %>%
   dplyr::select(proportion,name) %>%
   arrange(desc(proportion))
 
 
 diversity_cost_ex %>% 
 ggplot(aes(x=proportion,y=factor(reorder(name,proportion),levels=propor_cat_ex$name),fill=category))+
  geom_bar(position = "stack",stat="identity") +
   theme(legend.position = "top") +
   scale_fill_viridis_d()+
   scale_x_continuous(breaks = c(0,25,50,75,100)) +
   ylab("Top 50 Expensive Instituitions") +
   xlab("Proportion of Enrollment") +
   ggtitle("Enrollment in Expensive Educational Instituitions")
```

In Figure \@ref(fig:stack) it is clearly seen that the majority of enrolment in the top 50 expensive colleges in the US is that of white ethnicity followed by Hispanic, black and Asian ethnicities which form the minority.

```{r stackin, fig.width=10,fig.height=8, fig.cap="*The horizontal stacked bar plot shown here depicts the proportion of enrolments in the top 50 inexpensive educational institutions in the US, according to ethnicity. Majority of the enrolments in inexpensive schools are Hispanic population followed by Black and Asian population. The Native Hawaiian and American Indian population remain a minority in these schools as well. The inexpensive institutions are mostly community colleges.*"}
# joined the diversity and tuition cost dataset using an inner join 
# then calculated enrollment percentage for all the colleges using mutate
# then created a stacked barplot using ggplot and filled with different diversity groups for top 50 expensive colleges
 diversity_cost_inex <- econ  %>%
  
  inner_join(inex,by="name") 
 
 

diversity_cost_inex <-diversity_cost_inex%>%
  mutate(proportion=(enrollment/total_enrollment)*100) %>%
   arrange(desc(proportion))

propor_cat_inex <- diversity_cost_inex %>%
   filter(category=="White") %>%
   dplyr::select(proportion,name) %>%
   arrange(desc(proportion))
 

 diversity_cost_inex %>% 
 ggplot(aes(x=proportion,y=factor(reorder(name,proportion),levels=propor_cat_inex$name),fill=category))+
  geom_bar(position = "stack",stat="identity") +
   theme(legend.position = "top")+
   scale_fill_viridis_d()+
   scale_x_continuous(breaks = c(0,25,50,75,100))+
   ylab("Top 50 Inexpensive Instituitions") +
   xlab("Proportion of Enrollment") +
   ggtitle("Enrollment in Inexpensive Educational Instituitions")

 


```


In Figure \@ref(fig:stackin) it is observed that the majority of enrolment in the top 50 inexpensive colleges in the US is that of Hispanic, black and Asian population followed by white ethnic groups. The Native Hawaiian and American Indian students again form the minority amongst other groups in US universities. One of the reasons why the overwhelming enrolment of these ethnic groups in least expensive colleges could be that the majority of least expensive colleges are community colleges.

## Does paying high tuition guarantee a higher salary? Which college has more potential in career growth on the basis of initial salary offered?

As we have seen from the earlier sections, students make a huge investment in tuition fees to propel their careers. Through this section we intend to find out if this investment does indeed bear the expected results?

```{r tiplot, fig.height=6, fig.width=10, fig.cap="*Interactive Matrix scatter-plots showing correlation between the variables tuition, initial salary, mid-career pay, STEM and Impact. Institutes with higher tuition fee seem to produce alumni who earn high salary. *"}
# joined the tuition and salary datasets using an inner join and selected the variables related to this exploration
# Used ggpairs function to render a matrix scatterplot
library(plotly)
salary_tuition <- salary_potential %>%
  inner_join(tuition_cost,by="name") %>%
  dplyr::select(in_state_tuition,early_career_pay,mid_career_pay,make_world_better_percent,stem_percent)

lowerFn <- function(data, mapping, method = "lm", ...) {
  p <- ggplot(data = data, mapping = mapping) +
    geom_point(colour = "blue",size=0.5) +
    geom_smooth(method = method, color = "red", ...)
  p
}

p <- highlight_key(salary_tuition) %>%
ggpairs(salary_tuition,columnLabels = c("Tuition", "Initial Pay", "Mid Pay","Impact","STEM"),lower = list(continuous = wrap(lowerFn,method="lm")),title = "Relationship between Tuition ,Salary,Impact and STEM Percent") +
  
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) 

  ggplotly(p) %>%
  highlight("plotly_selected") %>%
    layout(margin=list(l = 100,t=50), yaxis=list(tickprefix=""))

```

To find out if there is any relation between tuition and career growth, we first joined the tuition and the salary datasets with the help of university names. Then we have produced a matrix scatter plot using the ggpairs function of *GGALLY package 2020*.

A matrix scatter plot is a powerful tool for visualising the correlation between various variables in a dataset. As can be seen from figure \@ref(fig:tiplot), apart from the Impact variable, which is a percentage provided by students who think they are making the world a better place, all the other variables show a positive correlation amongst each other. This suggests that paying a higher tuition fee does mean that a greater initial salary, mid career salary can be expected by the students. Another interesting point to note is that the presence of STEM students escalates the possibility of getting a better initial and mid career pay. STEM is an acronym for science, technology, engineering and mathematics. Having STEM courses in a university boosts the prospects of the university and thus, the students. 

There are also some values which are contradictory to the correlation. These can be found by hovering over the plot as the plot has been made interactive using the *plotly package 2020* in R. 

One such observation is where the initial pay is USD 81K, mid career pay is around USD 144k whereas the stem percent is only 2% and impact is 82%. Another being where tuition is just USD 7000 with above average initial pay of USD 62K and mid career pay of USD 120K.This differs from what is observed in the figure above where stem percentage and higher tuition cost aligns with higher initial and mid career salary.


After observing the correlation between tuition and initial salary, let us now look at the universities which offer the highest initial payment and check if they support the growth throughout the career.

```{r icgiplot, fig.width=10, fig.cap="*The dumbbell chart depicts Universities Offering the highest initial pay and whether the trend continues throughout the careers. Samuel Merritt University offers highest initial salary but a career growth of only 68.97%.*"}

# arranged the top paying uni in descending order and selected the first 25 universities. Used ggplot to display the highest salary and carrer growth using improvement calculated in earlier sections
top_pay_uni <- salary_potential %>%
  arrange(desc(early_career_pay)) %>%
  head(25)

ggplot(top_pay_uni, aes(x=early_career_pay, xend=mid_career_pay, y=reorder(name,early_career_pay))) + 
        geom_dumbbell(color="#a3c4dc", 
                      size=0.75, 
                      point.colour.l="#0e668b")+
  xlim(50000,165000)+
        geom_text(color="red", size=4,hjust=-0.5,
                  aes(x=mid_career_pay, label=paste0(round(top_pay_uni$improvement,2),"%"))) +
  xlab("Salary")+
  ylab("Educational Institutions")+
  ggtitle("Career growth in Universities offering highest initial salary")
```

Figure \@ref(fig:icgiplot) shows the top 25 highest initial salary offering universities. It appears that the universities offering the highest initial salary does not guarantee career growth. Samuel Merritt University offers highest initial salary but a career growth of only 68.97%. Career growth is the percentage increase in the salary of an individual half way through his career as compared to the initial salary.

The highest career growth is observed in Harvard University where the mid career salary almost doubles and a career growth of 96.26% is observed. Almost all except Samuel Merritt university show a career growth of more than 75% which is a satisfactory.

# Conclusion

Before exploring all the datasets at hand in greater depths, we asked ourselves the question, How valuable is the investment in American universities? After profound exploration, thorough analysis and meticulous inspection, we can safely say that we have an answer.

Firstly, we observed that majority of the American population, both non-residents and citizens enrol in public universities for higher education as the tuition fee is comparatively lower for public universities than private or for profit universities. Also, we noticed that non-residents pay more tuition fee in public universities than citizens of the US. Then we explored how much burden that is the tuition cost a student takes on average across various income groups. We also found out that universities also offer scholarships to eligible students with academic accolades and according to their economic backgrounds. Students with weaker economic backgrounds received more scholarships than those with better economic backgrounds there by reducing the net cost or burden on such students. 

Then we investigated which states in the US offer best career growth opportunities to students by calculating the improvement in their salaries half way into their careers. Almost all the states provided a growth percentage of more than 70% to the students which contributed immensely to us arriving at the answer for our primary research question.

We also probed into how alumni from different states think that they are contributing to make the world a better place. In most states almost 50% of the alumni think that they contribute towards making the world a better place. Then we looked at the different ethnic groups which are enrolled in US universities.

We then understood that US is accommodative towards different ethnic groups who want to live the American dream. We then examined how different states accommodate the minority groups in their prestigious  universities. We also studied how the most expensive and the most inexpensive colleges embrace the multi-cultural population. Finally, we scrutinized the correlation between the tuition cost, initial salary offered and the mid-career salary, all of which asserted a positive correlation. This authenticated the worthiness of the heavy investment students have to make in the form of tuition fees.

After diligent and rigorous exploration, we can safely say that pursuing a university degree from the US is definitely worth every penny which a student pays for a better future. 

# References

- Interactive Choropleth Map - Leaflet - a JavaScript library for interactive maps. (2020). Retrieved 18 September 2020, from https://leafletjs.com/examples/choropleth/

- Create Dumbbell Plots to Visualize Group Differences in R. (2020). Retrieved 18 September 2020, from https://towardsdatascience.com/create-dumbbell-plots-to-visualize-group-differences-in-r-3536b7d0a19a

- Sievert, C. (2020). 16 Client-side linking | Interactive web-based data visualization with R, plotly, and shiny. Retrieved 18 September 2020, from https://plotly-r.com/client-side-linking.html

- Letter value summaries. (2020). Retrieved 18 September 2020, from https://mgimond.github.io/ES218/Week08b.html

- (2020). Retrieved 18 September 2020, from https://www.r-project.org/conferences/useR-2006/Slides/HofmannEtAl.pdf

- Financial Assistance. (2020). Retrieved 18 September 2020, from https://www.curtis.edu/admissions/financial-assistance/

- Awarding Policies and Guidelines | Duke Financial Aid. (2020). Retrieved 18 September 2020, from https://financialaid.duke.edu/awarding-and-policy

- Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686
  
- Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2020). dplyr: A Grammar of Data Manipulation. R package version 1.0.1. https://CRAN.R-project.org/package=dplyr

- Hao Zhu (2019). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R package version 1.1.0. https://CRAN.R-project.org/package=kableExtra

- Claus O. Wilke (2020). ggridges: Ridgeline Plots in 'ggplot2'. R package version 0.5.2. https://CRAN.R-project.org/package=ggridges

- H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

- Simon Garnier (2018). viridis: Default Color Maps from 'matplotlib'. R package version 0.5.1. https://CRAN.R-project.org/package=viridis

- Bob Rudis (2020). hrbrthemes: Additional Themes, Theme Components and Utilities for 'ggplot2'. R package version 0.8.0. https://CRAN.R-project.org/package=hrbrthemes

- Baptiste Auguie (2017). gridExtra: Miscellaneous Functions for "Grid" Graphics. R package version 2.3. https://CRAN.R-project.org/package=gridExtra

- Hadley Wickham and Dana Seidel (2020). scales: Scale Functions for Visualization. R package version 1.1.1. https://CRAN.R-project.org/package=scales

- Yihui Xie, Joe Cheng and Xianying Tan (2020). DT: A Wrapper of the JavaScript Library 'DataTables'. R package version 0.15. https://CRAN.R-project.org/package=DT

- C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.

- R Core Team (2020). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

- Stefan McKinnon Edwards (2020). lemon: Freshing Up your 'ggplot2' Plots. R package version 0.4.5. https://CRAN.R-project.org/package=lemon

- Hadley Wickham and Heike Hofmann (2016). lvplot: Letter Value 'Boxplots'. R package version 0.2.0. https://CRAN.R-project.org/package=lvplot

- Tierney N (2017). “visdat: Visualising Whole Data Frames.” _JOSS_, *2*(16), 355. doi: 10.21105/joss.00355 (URL:
https://doi.org/10.21105/joss.00355), <URL: http://dx.doi.org/10.21105/joss.00355>.

- Barret Schloerke, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg and Jason Crowley (2020). GGally: Extension to 'ggplot2'. R package version 2.0.0. https://CRAN.R-project.org/package=GGally

- James Keirstead (2015). jkr: Functions and packages frequently used by James Keirstead. R package version 0.1.0.

- Bob Rudis, Ben Bolker and Jan Schulz (2017). ggalt: Extra Coordinate Systems, 'Geoms', Statistical Transformations, Scales and Fonts for 'ggplot2'. R package version 0.4.0. https://CRAN.R-project.org/package=ggalt

- Thomas Lin Pedersen and David Robinson (2020). gganimate: A Grammar of Animated Graphics. R package version 1.0.6. https://CRAN.R-project.org/package=gganimate

- Simon Urbanek (2013). png: Read and write PNG images. R package version 0.1-7. https://CRAN.R-project.org/package=png

- Jeroen Ooms (2018). gifski: Highest Quality GIF Encoder. R package version 0.8.6. https://CRAN.R-project.org/package=gifski

- Garrett Grolemund, Hadley Wickham (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. URL http://www.jstatsoft.org/v40/i03/.

