---
title: "ETC5521 Assignment 1"
subtitle: "Education System in the US"
team: Magpie
author:
  - Junhao Wang 
  - Priya Ravindra Dingorkar
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = F)
library(tidyverse)
library(dplyr)
library(kableExtra)
library(ggridges)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(gridExtra)
library(scales)
library(DT)
library(plotly)
library(grid)
library(lemon)
library(lvplot)
library(visdat)
# devtools::install_github("hrbrmstr/ggalt")
#install.packages("lvplot")
#devtools::install_github("josiahpjking/jkr")
library(jkr)
library(ggalt)
library(gganimate)
```

# Acknowledgements

Our sincere gratitude goes out for their guidance and encouragement to Professor Dianne Cook, Dr Emi Tanka, and the tutors Sayani Gupta and Sherry Zhang. Their culminating efforts have placed us in a position where we can generate this report collaboratively.

# Introduction and Motivation

Attending a university course is a big decision for students, because it will have a large effect on the advancement of a person's future, with a huge cost to both money and time, based on the above evidence, we can conclude that going to university is indeed an investment and the return on investment is very worrying. 

Since everyone knows that the US is one of the most popular yet costly higher education destinations in the world, and the cost range is wide (for example: tuition fees range from $5,000 to $50,000 (£4,074-£ 40,746) per annual). Most undergraduate degrees last four years, so on average students graduate with a debt worth $132,860 (£101,505), we are interested in how good the investment in American education is.

In this report , we will look at the various factors that influence the U.S. education and whether studying at the renowned U.S. universities is really worth the investment. On thorough analysis of this we have realized there are several variables in the dataset that enabled us to assess the cost and expenditure of studying in the United States. We have tried our best to cover most of the important variables which allows us to evaluate and analyse efficiently. Since most variables have character datatypes, and a few in numeric, the visualisation scope is very limited.

```{r dat-load, message = FALSE, echo=FALSE}
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')

tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 

salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')

historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')

diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv')
```

# Research Question

## Primary Question

How valuable is the investment in education among America universities? 

Since tuition fee is relatively high for most students, or their families, value for money is of great concern. This question is to decover how highly valued are the tuition fees among universities in America, by analysing the various aspects of the education system in US.

## Secondary Questions

* How does the tuition fee vary across the different types of institutions? 
This information can be drawn from tuition cost, and can give a point of view of the American education system.

* What is the ratio of net-cost to total cost among America universities?
This can show how much burden a student has taken.

* How is student's career development among America universities? 
This information can be drawn from *salary_potential*, if middle-career pay differ a lot from early-career pay, then we believe there is a well career development in that university.

* How does the tuition rate vary over the various years for the various types of courses?

* What is percentage of enrolment of the diverse population studying, across the US ?

* *Are all States and universities accommodative of students of different ethnic and economic backgrounds?*

* *Does paying high tuition guarantee a higher salary? Which college has more potential in career growth on the basis of initial salary offered?*


# Analysis and Findings

One of the key reasons students chose to study in the USA is the prestige of the country for renowned higher education programs. Completing a degree from one of the best higher education programs in the world would make you stand out from peers of similar backgrounds and job experiences. 

Let us examine and know the important facts about the US education system. We look at the various aspects when studying, the diversity of education, the history of education, the cost of tuition, income among people people in the United States, the different wages currently on the market, and similar exciting analyses.

## The Distribution of Tuition Fees in US.

Let us look at the distribution of the spectrum of tuition fees in the United States for residents and non-residents of the United States across the various types of institutions in the United States

```{r dist-tut, fig.cap="Distribution of Tuition Fees in US", fig.align='center', message=FALSE, warning=FALSE}

library(gridExtra)
ridges_dat <- tuition_cost %>% dplyr::filter(tuition_cost$type != "Other") 

```


```{r,message=FALSE, warning=FALSE}

# a histogram (probability densities instead of frequencies) + density is plotted to distinguish between non residents and residents. campus & degree length is also taken into consideration 

cols <- c("Residents"="#457b9d","Non Residents"="red")
two <- ridges_dat %>%
  filter(degree_length=="2 Year")%>%
  ggplot()+
  geom_histogram(aes(x = in_state_tuition,y=..density..,fill="Residents"))+
  geom_density(aes(x=out_of_state_tuition,color="Non Residents"))+
  facet_wrap(~type)+
  xlab("Tuition")+ylab("Density")+
  ggtitle("2 Year Degree")+
  scale_colour_manual(name="",values=cols) + scale_fill_manual(name="",values=cols) 

four <- ridges_dat %>%
  filter(degree_length=="4 Year")%>%
  ggplot()+
  geom_histogram(aes(x = in_state_tuition,y=..density..,fill="Residents"))+
  geom_density(aes(x=out_of_state_tuition,color="Non Residents"))+
  facet_wrap(~type)+
  xlab("Tuition")+
  ylab("Density")+
  ggtitle("4 Year Degree")+
  scale_colour_manual(name="",values=cols) + 
  scale_fill_manual(name="",values=cols)




```



```{r tuitiondist, fig.cap="*The histogram and density distribution shows the distribution of tuition feesof residents and non-residents of US across 2-Year and 4-Year degree courses. Though both residents and non-residents enrol more in public universities, non-residents end up paying more.*", fig.align='center', fig.height=6.5, message=FALSE, warning=FALSE}
grid_arrange_shared_legend(two,four,ncol=1, nrow=2)
```

Figure \@ref(fig:tuitiondist) displays the distribution of tuition fees for the residents and non-residents of US. Majorly the universities in the US offer two types of degree courses, which are a 2-Year degree course and a 4-Year degree courses. 2-Year degree courses are predominantly for students enrolled in a master's degree and 4-Year degree courses are generally offered to students pursuing a bachelor's degree. We have separated the two and plotted two different graphs as tuition fee varies majorly for the two different types of courses offered. As seen in \@ref(fig:), the red density plot depicts the tuition fee for non-residents and the histogram depicts the tuition fee for residents. We observe that the density in private universities is low as compared to the other two as this may be due to the higher expense of fees in private universities. It is clear from the above figure that both citizens and non-residents of the US enrol in for profit or public universities to pursue higher education. Another noticeable fact is that, in public universities, non-residents end up paying more than citizens of the US.

## Difference in fees after any Scholarship / Awards Earned

A lot of students receive grants and scholarships of various kinds. Through this section, we will understand how the grants/scholarships are awarded to students of various income groups how much cost students end up paying across various income groups.

```{r stunetfee, fig.cap="*The stacked barplot shows the average net cost students pay across various income groups over the years for off campus and on campus education in US universities.*", fig.align='center', fig.height=9, fig.width=9, message=FALSE, warning=FALSE}
# changes made --> instead of sum, grouped and took average . campus is also taken into consideration 
tuition_income$income_lvl <- recode(tuition_income$income_lvl,
                                  "48_001 to 75,000"="48,001 to 75,000") 
tuition_incometest <- tuition_income %>%
  mutate(net_cost=round(net_cost,2)) %>%

  
  group_by(year,campus,income_lvl)%>%
  summarise(each=mean(net_cost))

plo <- ggplot(tuition_incometest, aes(income_lvl,each, fill=campus)) +
  geom_col(position = 'dodge') +
  facet_wrap(~year) + 
  theme(axis.text.x = element_text(angle=90)) +
  ggtitle("Average Cost incurred after Scholarship for each Income group") +  
  xlab("Income Level of the University Applicants")+
  ylab("Difference in the Fees after Scholarship")
plo



```

```{r stuscholar, fig.cap="*The stacked barplot show the amount of scholarships students earn across various income groups in US universities over the yearsfor on campus and off campus education.*", fig.align='center', fig.height=9, fig.width=9, message=FALSE, warning=FALSE}
# changes made --> instead of sum, grouped and took average. campus is also taken into consideration 
 tuition_income %>% 
  mutate(diff = total_price - net_cost) %>%
  group_by(year,campus,income_lvl)%>%
  summarise(eachscho=mean(diff))  %>%

ggplot( aes(x=income_lvl, y=eachscho, fill= campus)) +
  geom_col(position ='dodge') +
  facet_wrap(~year) + 
  theme(axis.text.x = element_text(angle=90)) + 
  labs(y="Scholarship", 
       x="Income Level of the University Applicants"
      ) +
  ggtitle("Average Scholarship Received by each Income Group")

```

In the US, university courses are broadly offered on campus and off campus. Though there is only a little difference between the net_cost of both on campus and off campus courses, the total_cost varies significantly and hence we have displayed them independent of each other. In figure \@ref(fig:stunetfee) we have the average cost that a student incurs across various income groups and in figure \@ref(fig:stuscholar) we have the scholarships earned by students across various income groups. A point to note is that the variable net_cost has a lot of *negative values*. One may wonder how can the tuition paid be negative. Upon further probing we found out that a lot of universities provide financial assistance to students and extend it to their families as well. This is the reason the variable net_cost shows negative values. Also, the data for on campus courses for the year 2010 is missing. Besides we have also recoded the category of income level of *48,001 to 75,000* which earlier was *48_000 to 75,000*.

In Figure \@ref(fig:stunetfee) we group by the year, net cost and the income levels and summarise using the mean to arrive at the average tuition cost students pay across various income groups. It is clear from the figure that students in lower income groups tend to tae less burden of tuition fee as compared to students with higher income groups over the years.

In figure \@ref(fig:stuscholar) we obtain the amount of scholarship earned by the students by finding out the difference between the total_cost an net_cost. Then we summarise using the mean to arrive at the average scholarship earned by each income group. Clearly, students in lower income groups earn more scholarships as compared to those in higher income groups over the years. An interesting point to note is that in 2017 and 2018 the income group of over 110,000 the off campus students have received more scholarships than on campus students.


## Does paying high tuition guarantee a higher salary? Which college has more potential in career growth on the basis of initial salary offered? 

```{r , fig.height=5}
library(plotly)
salary_tuition <- salary_potential %>%
  inner_join(tuition_cost,by="name") %>%
  select(in_state_tuition,early_career_pay,mid_career_pay,make_world_better_percent,stem_percent)

mean(salary_tuition$in_state_tuition)
mean(salary_tuition$early_career_pay)
mean(salary_tuition$mid_career_pay)

lowerFn <- function(data, mapping, method = "lm", ...) {
  p <- ggplot(data = data, mapping = mapping) +
    geom_point(colour = "blue",size=0.5) +
    geom_smooth(method = method, color = "red", ...)
  p
}

p <- highlight_key(salary_tuition) %>%
ggpairs(salary_tuition,columnLabels = c("Tuition", "Initial Pay", "Mid Pay","Impact","STEM"),lower = list(continuous = wrap(lowerFn,method="lm")),title = "Relationship between Tuition ,Salary,Impact and STEM Percent") +
  
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) 

  ggplotly(p) %>%
  highlight("plotly_selected") %>%
    layout(margin=list(l = 100,t=50), yaxis=list(tickprefix=""))

```

Tuition and pay has positive correlation 

STEM has positive correlation with everything except impact perentage. There are values which are contradictory. Initial pay 81,000,mid pay 144k,stem percent=2 and impct is 82. 


some unis with lower tuition (7k) have above average initial (66k) and mid pay(120k). 


```{r,fig.height=8}


top_pay_uni <- salary_potential %>%
  arrange(desc(early_career_pay)) %>%
  head(25)

ggplot(top_pay_uni, aes(x=early_career_pay, xend=mid_career_pay, y=reorder(name,early_career_pay))) + 
        geom_dumbbell(color="#a3c4dc", 
                      size=0.75, 
                      point.colour.l="#0e668b")+
  xlim(50000,165000)+
        geom_text(color="red", size=4,hjust=-0.5,
                  aes(x=mid_career_pay, label=paste0(round(top_pay_uni$improvement,2),"%"))) 
```

# Conclusion

The standard of U.S. education is of highly remarkable. Through our study, we saw distribution of tuition fees in the U.S. and concluded that residents and non-residents tend to go to public and prosperous universities with good tuition fees. Furthermore, we witnessed that the US education system provides various grants and scholarships in the case of applicants having a strong profile and a lower income level to enable the student enter to the desired university.

On admission we saw the numerous states across the USA showing great progress in the growth of the student career in terms of their salary potential. Through our study we found that students' growth is mostly above 50 percent. We also saw alumni contributions from the various states around the US. Finally, we've seen the various diverse populace found in the US.

Through the exploration of the dataset, therefore, we infer that, if you study in the U.S., you will mainly enter a public and private university, you will earn various scholarships and grants according to your level of income and profile. Upon completion of your schooling, we saw the breadth of the career growth of the applicant, which showed promising results, and witnessed the U.S. schooling in global diversity while making you more global and providing the right exposure.

So we get to the point and answer our primary research question, Yes, U.S. education is value-for-money and the investment really is worth it. The returns from these investments are compelling, too.

# References

* Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source
  Software, 4(43), 1686. https://doi.org/10.21105/joss.01686
  
* Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2020). dplyr: A
  Grammar of Data Manipulation. R package version 1.0.1.
  https://CRAN.R-project.org/package=dplyr
  
* Hao Zhu (2019). kableExtra: Construct Complex Table with 'kable' and Pipe
  Syntax. R package version 1.1.0. https://CRAN.R-project.org/package=kableExtra

* Claus O. Wilke (2020). ggridges: Ridgeline Plots in 'ggplot2'. R package version
  0.5.2. https://CRAN.R-project.org/package=ggridges
  
* H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New
  York, 2016.

* Simon Garnier (2018). viridis: Default Color Maps from 'matplotlib'. R package
  version 0.5.1. https://CRAN.R-project.org/package=viridis

* Bob Rudis (2020). hrbrthemes: Additional Themes, Theme Components and Utilities
  for 'ggplot2'. R package version 0.8.0.
  https://CRAN.R-project.org/package=hrbrthemes

* Baptiste Auguie (2017). gridExtra: Miscellaneous Functions for "Grid" Graphics.
  R package version 2.3. https://CRAN.R-project.org/package=gridExtra

* Hadley Wickham and Dana Seidel (2020). scales: Scale Functions for
  Visualization. R package version 1.1.1.
  https://CRAN.R-project.org/package=scales

* Yihui Xie, Joe Cheng and Xianying Tan (2020). DT: A Wrapper of the JavaScript
  Library 'DataTables'. R package version 0.15.
  https://CRAN.R-project.org/package=DT
  
* C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny.
  Chapman and Hall/CRC Florida, 2020.

* Top 50 ggplot2 Visualizations - The Master List (With Full R Code). (2020). Retrieved 28 August 2020, from http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html

* Holtz, Y. (2020). The R Graph Gallery – Help and inspiration for R charts. Retrieved 28 August 2020, from https://www.r-graph-gallery.com/

* rfordatascience/tidytuesday. (2020). Retrieved 28 August 2020, from https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-10/readme.md

* Tuition Tracker. (2020). Retrieved 28 August 2020, from https://www.tuitiontracker.org/

* Fast Facts: Tuition costs of colleges and universities (76). (2020). Retrieved 28 August 2020, from https://nces.ed.gov/fastfacts/display.asp?id=76

* Tuition and Fees, 1998-99 Through 2018-19. (2020). Retrieved 28 August 2020, from https://www.chronicle.com/article/tuition-and-fees-1998-99-through-2018-19/

* The cost of studying at a university in the United States. (2020). Retrieved 28 August 2020, from https://www.timeshighereducation.com/student/advice/cost-studying-university-united-states


